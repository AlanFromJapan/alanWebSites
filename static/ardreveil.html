<html>
  <head>
    <title>kalshagar - ardReveil</title>
    <link rel="stylesheet" href="static/style.css" type="text/css" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  </head>
  <body>
    <div class="wiki" id="content_view" style="display: block;">
<h2 id="toc0"><a name="x-ardReveil vI, its incredible life"></a> ardReveil vI, its incredible life </h2>
<strong>2009-08-14</strong> : <img src="files/skull-crossbones1.gif" alt="skull-crossbones1.gif" title="skull-crossbones1.gif" /><span style="background-color: #FA9999">This project is a failure. Once everything assembled, it worked perfectly ... for 10 minutes. Then the Arduino just died. So I used another one (unsolder/resolder) everything. And it worked perfectly ... for a couple of days before the Arduino also died. I'll poste the schema here to see why it failed (if someone can help ... please).</span><br />
 (see above) for an unknown reason, it died after 2 days. Nothing works anymore, only power led turns on and ... that's all. Life sucks.<br />
<strong>2009-12-20</strong> : for an unknown reason the ardReveil decided to ... come back to life! Just plugged it to the usb for ... don't know, yet it's christmas so let's hope for miracle. And it worked all day ! Tonight plugged back on AC wallwart ... and works (for now). Shall I assume that there is a shortcircuit somewhere that I fixed by opening the box again ? Freaks me out ... (Oo;)<br />
<strong>2010-01-01</strong>: <img src="files/heart.gif" alt="heart.gif" title="heart.gif" /><span style="background-color: #5bff00">it's working fine for days, except that programatically time can't be changed. So I implemented new functions such as menu (I use the touch screen divided in 4 zones as input), time offset (since you can't change time, you can still adjust it) and alarm setting on/off. Plus little label, this time it's finished \(^o^)/</span><br />
<strong>2010-03-02</strong> : <img src="files/skull-crossbones1.gif" alt="skull-crossbones1.gif" title="skull-crossbones1.gif" /><span style="background-color: #FA9999">2 months and a half working fine, waking me up everyday ... and then like last year : pffft, not working anymore. Tried to let it rest a day or two, no outcome. Nothing. Life sucks.</span><br />
<strong>2010-03-13</strong> : <span style="background-color: #5bff00">Well ... it works back. Tired a few time the past days : nothing. And today, tadaaa, it works again. If someone has an idea, please tell me. Anyway, it came back to life, as did my will to make new electronic stuffs.</span><br />
<strong>2010-03-13</strong> : <img src="files/skull-crossbones1.gif" alt="skull-crossbones1.gif" title="skull-crossbones1.gif" /><span style="background-color: #FA9999">Last post %20 30min : just died again. Condensator problem ? That would explain the time factor (the longer you way the more it works), won't it ? Life sucks.</span><br />
<strong>2010-07-12</strong> : call me stuborn but I have not forgotten this little one. I plan to remove the arduino inside and put instead a home made arduino-like. It will be easier to update and change the code I think. Well and ... I'm short on idea, you noticed, didn't you? Hope this might help me understand that strange state of fact.<br />
<br />
<h2 id="toc1"><a name="x-Purpose"></a> Purpose </h2>
Create a <em>reveil</em> (&quot;alarm clock&quot;) powered by a Arduino, with some nice things inside:<br />
<ul><li>Touch sensitive (use DS touch screen) : to light up, to stop ringing, to interact (no button save the on-off)</li><li>Soft display : no agressive light, just show me the time when I touch you</li><li>Nice colors (rgb ambient)</li><li>Smart : I want a clock that ring MON-FRI at 8:00 and let me sleep on weekend!</li><li><strong>See <a class="wiki_link" href="Arduino%20and%20a%20Real%20Time%20Clock%20%28RTC%29.html">Arduino and a Real Time Clock (RTC)</a></strong></li><li>Music : play some tunes for wake up<ul><li>Uses only a speaker and frequence generation. Result is simple but acceptable (not as good as the sound of the next version <a class="wiki_link" href="ardReveil%20v2.html">ardReveil v2</a></li></ul></li><li>Usual alarm clock functions :<ul><li>Snooze</li><li>Wakeup time can be programmed via the touch pad</li><li>Alarm can be turned off by menu via touch pad</li></ul></li></ul><br />
<h2 id="toc2"><a name="x-Pictures"></a> Pictures </h2>


<table class="wiki_table">
    <tr>
        <td><img src="files/n704343789_2232389_3852834.jpg" alt="n704343789_2232389_3852834.jpg" title="n704343789_2232389_3852834.jpg" style="width: 400px;" /><br />
The ardReveil : top = touch screen, fromt = 2x16 char white on black parallel LCD, bottom = main board<br />
</td>
        <td><img src="files/n704343789_2232390_7051706.jpg" alt="n704343789_2232390_7051706.jpg" title="n704343789_2232390_7051706.jpg" style="width: 400px;" /><br />
The ardReveil : front = the speaker (from a headphone), left = Arduino Pro 5V ATmel 168 16 Mhz (but running 8 MHz), in the middle = RTC clock (small red breakboard)<br />
</td>
    </tr>
    <tr>
        <td><img src="files/19670_228902773789_704343789_3187990_7971283_n.jpg" alt="19670_228902773789_704343789_3187990_7971283_n.jpg" title="19670_228902773789_704343789_3187990_7971283_n.jpg" style="width: 400px;" /> <br />
v0.3.2 with the labels on the touchscreen and menu<br />
</td>
        <td><img src="files/19670_228903118789_704343789_3187992_885782_n.jpg" alt="19670_228903118789_704343789_3187992_885782_n.jpg" title="19670_228903118789_704343789_3187992_885782_n.jpg" style="width: 400px;" /><br />
</td>
    </tr>
    <tr>
        <td><img src="files/19670_228903393789_704343789_3187993_2163543_n.jpg" alt="19670_228903393789_704343789_3187993_2163543_n.jpg" title="19670_228903393789_704343789_3187993_2163543_n.jpg" style="width: 400px;" /><br />
</td>
        <td><img src="files/19670_228903703789_704343789_3187996_6777628_n.jpg" alt="19670_228903703789_704343789_3187996_6777628_n.jpg" title="19670_228903703789_704343789_3187996_6777628_n.jpg" style="width: 400px;" /><br />
</td>
    </tr>
</table>

<br />
<h2 id="toc3"><a name="x-Code"></a> Code </h2>
<A  href="files/ardReveil.I.v0.3.2.zip.html">ardReveil.I.v0.3.2.zip</a><br />
All the files, main .pde %20 satellite .h files for controlling subsystems.<br />
<br />
<h2 id="toc4"><a name="x-Inside"></a> Inside </h2>
<ul><li>Arduino mini 8Mhz is sufficient <em>but</em> Japanese resseller is short, so I bought a Arduino pro 5V 16 MHz (no step up necessary for the RTC) <em>but</em> it is a ATmel 168! (half the space of a ATmel 328). And funny thing is that the core for the Arduino Pro is <em>only for the 8Mhz</em>. So your program run too fast and can't communicate properly. You have to turn down the speed of your ATmel, so use the CLKPR register (Clock Prescale Divider). ATmel doc explains the value to setup and you just have to do explained here <a class="wiki_link_ext" href="http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?num=1163418637" rel="nofollow">http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?num=1163418637</a><ul><li>EDIT: however, since after 10 minutes plugged to the 9V DC wart the Arduino Pro just DIED, I had to un-solder and resolder everything to a small Arduino Mini 328, solving space and speed problem. Just in case, I pre-mounted a voltage regulator (LM317) to pre-clean the voltage before the card (don't want to kill another one)</li></ul></li></ul>
<style type="text/css"><!--
/**
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 */
.c  {font-family:monospace;}
.c .imp {font-weight: bold; color: red;}
.c .kw1 {color: #b1b100;}
.c .kw2 {color: #000000; font-weight: bold;}
.c .kw3 {color: #000066;}
.c .kw4 {color: #993333;}
.c .co1 {color: #666666; font-style: italic;}
.c .co2 {color: #339933;}
.c .coMULTI {color: #808080; font-style: italic;}
.c .es0 {color: #000099; font-weight: bold;}
.c .es1 {color: #000099; font-weight: bold;}
.c .es2 {color: #660099; font-weight: bold;}
.c .es3 {color: #660099; font-weight: bold;}
.c .es4 {color: #660099; font-weight: bold;}
.c .es5 {color: #006699; font-weight: bold;}
.c .br0 {color: #009900;}
.c .sy0 {color: #339933;}
.c .st0 {color: #ff0000;}
.c .nu0 {color: #0000dd;}
.c .nu6 {color: #208080;}
.c .nu8 {color: #208080;}
.c .nu12 {color: #208080;}
.c .nu16 {color:#800080;}
.c .nu17 {color:#800080;}
.c .nu18 {color:#800080;}
.c .nu19 {color:#800080;}
.c .me1 {color: #202020;}
.c .me2 {color: #202020;}
.c span.xtra { display:block; }

-->
</style><pre class="c">  <span class="co1">// That arduino pro board is 16 mHz BUT the bootloader is made for 8MHz so force the </span>
  <span class="co1">// Arduino to run half speed (force 8MHz)</span>
  CLKPR <span class="sy0">=</span> <span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">&lt;&lt;</span>CLKPCE<span class="br0">&#41;</span><span class="sy0">;</span>
  CLKPR <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> <span class="co1">// Divide by 2 </span></pre>

<ul><li>Other funny thing with the ATmel 168 is that we are missing space ! 16 ko for memory is short, very short for a program that pilot a touchscreen, generates sound, talks to a RTC via I2C and makes one or 2 useful things. No assembler required, but it requires being written consisely.</li><li>DS Touch screen %20 connector break board</li><li>Real time clock module <a class="wiki_link_ext" href="http://www.sparkfun.com/commerce/product_info.php?products_id=99" rel="nofollow">http://www.sparkfun.com/commerce/product_info.php?products_id=99</a></li><li>Nice white on black display (maybe turn rgb) <a class="wiki_link_ext" href="http://www.sparkfun.com/commerce/product_info.php?products_id=709" rel="nofollow">http://www.sparkfun.com/commerce/product_info.php?products_id=709</a></li></ul>
    </div>
  </body>
</html>